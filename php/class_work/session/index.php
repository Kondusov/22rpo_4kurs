<?php
// 1. Работа с сессиями:
// Всегда вызывайте session_start() в самом начале скрипта, до любого вывода в браузер.
session_start();

// Проверяем, установлено ли имя пользователя в сессии
if (isset($_SESSION['username'])) {
    $session_message = "С возвращением, {$_SESSION['username']} (из сессии)!";
} else {
    // Если нет, устанавливаем его (например, после успешного входа в систему)
    $_SESSION['username'] = 'Пользователь_Сессии';
    $session_message = "Привет, новый пользователь! Ваше имя сохранено в сессии.";
}

// 2. Работа с куки:
// Установка куки также должна происходить до любого вывода в браузер.
$cookie_name = 'user_pref';
$cookie_value = 'Пользователь_Куки';
$cookie_expiry = time() + (86400 * 30); // Срок действия - 30 дней (86400 секунд в дне)

// Проверяем, установлено ли куки
if (!isset($_COOKIE[$cookie_name])) {
    // Если нет, устанавливаем его.
    setcookie($cookie_name, $cookie_value, $cookie_expiry, "/"); // "/" означает доступность на всем сайте
    $cookie_message = "Куки '{$cookie_name}' установлено на 30 дней.";
} else {
    $cookie_message = "Куки '{$cookie_name}' уже установлено. Значение: {$_COOKIE[$cookie_name]}.";
}
?>

<!DOCTYPE html>
<html lang="ru">
<head>
    <meta charset="UTF-8">
    <title>Пример Сессий и Куки</title>
</head>
<body>
    <h1>Демонстрация использования сессий и куки</h1>

    <h2>Сессия</h2>
    <p><?php echo $session_message; ?></p>
    <p>Перезагрузите страницу, чтобы увидеть, что сессия сохраняется в течение одного сеанса браузера.</p>

    <h2>Куки</h2>
    <p><?php echo $cookie_message; ?></p>
    <p>Куки будут храниться даже после закрытия и повторного открытия браузера (в течение 30 дней).</p>
    
    <!-- Ссылка для выхода/уничтожения сессии и удаления куки -->
    <p><a href="logout.php">Выйти / Удалить данные</a></p>
</body>
</html>